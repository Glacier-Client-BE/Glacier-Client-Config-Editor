<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glacier Client Config Editor</title>
    <meta property="og:title" content="Glacier Client Config Editor" />
    <meta property="og:description" content="Configure your Glacier Client modules and settings online." />
    <meta property="og:image" content="https://placehold.co/1200x630/7289DA/FFFFFF?text=Glacier+Config+Editor" />
    <meta property="og:url" content="https://config.glacierclient.xyz" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@glacierclientbe" />
    <meta name="twitter:title" content="Glacier Client Config Editor" />
    <meta name="twitter:description" content="Configure your Glacier Client modules and settings online." />
    <meta name="twitter:image" content="https://placehold.co/1200x675/7289DA/FFFFFF?text=Glacier+Config+Editor" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.49.0/min/vs/loader.js"></script>
    <style>
        :root {
            --color-primary: #7289DA;
            --color-dark: #1A1A1A;
            --color-dark-alt: #2D2D2D;
            --color-text: #FFFFFF;
            --color-text-alt: #D9D9D9;
            --glass-border-color: rgba(114, 137, 218, 0.2);
            --hover-bg: rgba(114, 137, 218, 0.1);
            --active-bg: rgba(114, 137, 218, 0.2);
            --input-bg: rgba(255, 255, 255, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.3);
            --toggle-off-bg: #4A4A5E;
            --toggle-on-bg: var(--color-primary);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: var(--color-dark);
            color: var(--color-text);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--color-primary);
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 999;
        }

        header h1 {
            font-size: 2.25rem;
            font-weight: 800;
            color: var(--color-primary);
            letter-spacing: -0.05em;
            text-shadow: 0 0 15px rgba(114, 137, 218, 0.5);
        }

        .panel {
            background: var(--color-dark-alt);
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            border: 1px solid rgba(114, 137, 218, 0.2);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            padding: 2.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease, background-color 0.5s ease-in-out;
        }

        .panel:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.5);
            border-color: var(--color-primary);
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-text);
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(114, 137, 218, 0.4);
            text-decoration: none;
        }

        .btn-primary:hover {
            transform: translateY(-5px);
            background: #5b6eae;
            box-shadow: 0 8px 20px rgba(114, 137, 218, 0.6);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .input-field, .select-field {
            background: var(--color-dark);
            color: var(--color-text);
            border: 2px solid var(--glass-border-color);
            padding: 0.8rem 1rem;
            border-radius: 8px;
            width: 100%;
            transition: border-color 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
        }

        .input-field:focus, .select-field:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 10px rgba(114, 137, 218, 0.5);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--toggle-off-bg);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--toggle-on-bg);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--toggle-on-bg);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        #json-editor-container {
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--glass-border-color);
            box-shadow: 0 5px 15px var(--shadow-color);
            transition: border-color 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
            min-height: 600px;
        }

        .panel h2 {
            color: var(--color-text);
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--glass-border-color);
            padding-bottom: 0.8rem;
            display: flex;
            align-items: center;
        }

        .panel h2 i {
            color: var(--color-primary);
            margin-right: 0.75rem;
            transition: transform 0.3s ease;
        }

        footer {
            background: var(--color-dark);
            border-top: 2px solid var(--color-primary);
            padding: 2.5rem 0;
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-alt);
            margin-top: 3rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .animate-fade-in-up {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .animate-fade-in-up.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .delay-1 { transition-delay: 0.1s; }
        .delay-2 { transition-delay: 0.2s; }
        .delay-3 { transition-delay: 0.3s; }
        .delay-4 { transition-delay: 0.4s; }
        .delay-5 { transition-delay: 0.5s; }
        .delay-6 { transition-delay: 0.6s; }
        .delay-7 { transition-delay: 0.7s; }
        .delay-8 { transition-delay: 0.8s; }
        .delay-9 { transition-delay: 0.9s; }
        .delay-10 { transition-delay: 1.0s; }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--color-primary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 0.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <header>
        <h1 class="text-4xl font-extrabold tracking-tight">Glacier Client Config Editor</h1>
    </header>

    <main class="flex-grow p-6 flex flex-col items-center justify-center">
        <div class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="panel flex flex-col animate-fade-in-up delay-1">
                <h2 class="text-2xl font-bold mb-6">
                    <i class="fas fa-sliders-h mr-2"></i>Module Configuration
                </h2>
                <div id="config-form" class="space-y-6 overflow-auto max-h-[70vh] pr-4">
                    <p class="text-color-text-alt italic text-center">Loading configuration...</p>
                </div>
                <button id="download-config-btn" class="btn-primary mt-8">
                    <i class="fas fa-download mr-2"></i> Download config.json
                </button>
            </div>

            <div class="panel flex flex-col animate-fade-in-up delay-2">
                <h2 class="text-2xl font-bold mb-6">
                    <i class="fas fa-code mr-2"></i>Raw config.json
                </h2>
                <div id="json-editor-container" class="flex-grow"></div>
                <button id="copy-json-btn" class="btn-primary mt-4">
                    <i class="fas fa-copy mr-2"></i> Copy JSON
                </button>
                <p class="text-sm text-color-text-alt mt-4 text-center">
                    Disclaimer: Only edit the anchor and offset if you have knowledge about JSON UI. Replace each value with either true (automatically on) or false (automatically off) to make the config work. Mods are saved when leaving the world or entering another dimension. Only toggle between true/false, change opacity, mod position (read disclaimer), or item id/aux. Changing anything else may break the pack.
                </p>
            </div>
        </div>
    </main>

    <footer>
        &copy; 2025 Glacier Client Config Editor. All rights reserved.
    </footer>

    <script type="module">
        const configForm = document.getElementById('config-form');
        const jsonEditorContainer = document.getElementById('json-editor-container');
        const downloadConfigBtn = document.getElementById('download-config-btn');
        const copyJsonBtn = document.getElementById('copy-json-btn');

        let currentConfig = {};
        let monacoEditor;
        let updateFormTimeout;

        function sanitizeKeyForDisplay(key) {
            let displayKey = key.replace(/@gc\.pnl|\$|\|default/g, '')
                                .replace(/_/g, ' ')
                                .trim();
            return displayKey.replace(/\b\w/g, char => char.toUpperCase());
        }

        const anchorOptions = [
            "top_left", "top_middle", "top_right",
            "left_middle", "center", "right_middle",
            "bottom_left", "bottom_middle", "bottom_right"
        ];

        const chatToggleOptions = { 0: "Bottom Chat", 1: "Top Chat" };
        const hotbarToggleOptions = { 0: "Default", 1: "Connected", 2: "RGB" };
        const inventoryHudToggleOptions = { 0: "Horizontal", 1: "Vertical" };
        const mainhandDurabilityToggleOptions = { 0: "Absolute", 1: "Percentage" };

        function renderConfigForm(config) {
            configForm.innerHTML = '';
            const mainConfig = config["mod_menu_config@gc.pnl"];
            const pauseMenuConfig = config["pause_menu_config@gc.pnl"];
            const containerConfig = config["container_config@gc.pnl"];

            const createFormGroup = (label, inputHtml) => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between gap-4';
                const labelElem = document.createElement('label');
                labelElem.className = 'text-color-text text-lg font-medium flex-grow';
                labelElem.textContent = label;
                div.appendChild(labelElem);
                div.innerHTML += inputHtml;
                return div;
            };

            const createSectionHeader = (title) => {
                const h3 = document.createElement('h3');
                h3.className = 'text-xl font-semibold text-color-primary mt-6 mb-4 border-b border-glass-border-color pb-2';
                h3.textContent = title;
                return h3;
            };

            configForm.appendChild(createSectionHeader('Modules Configuration'));
            for (const key in mainConfig) {
                if (mainConfig.hasOwnProperty(key)) {
                    const cleanKey = key.replace(/\|default/g, '');
                    const displayLabel = sanitizeKeyForDisplay(key);
                    let inputHtml = '';
                    let value = mainConfig[key];

                    const dataOriginalKey = `data-original-key="${key}"`;

                    if (cleanKey.startsWith('$hotbar_number')) {
                        inputHtml = `<input type="text" id="${cleanKey}" ${dataOriginalKey} value="${value}" class="input-field w-auto min-w-[100px] text-center" />`;
                    } else if (cleanKey.endsWith('_item_id') || cleanKey.endsWith('_aux')) {
                        inputHtml = `<input type="number" id="${cleanKey}" ${dataOriginalKey} value="${value}" class="input-field w-auto min-w-[120px] text-center" />`;
                    } else if (Array.isArray(value) && value.length === 2) {
                        inputHtml = `
                            <div class="flex gap-2">
                                <input type="number" id="${cleanKey}_x" ${dataOriginalKey} value="${value[0]}" class="input-field w-24 text-center" placeholder="X" />
                                <input type="number" id="${cleanKey}_y" ${dataOriginalKey} value="${value[1]}" class="input-field w-24 text-center" placeholder="Y" />
                            </div>
                        `;
                    } else if (typeof value === 'boolean') {
                        inputHtml = `
                            <label class="toggle-switch">
                                <input type="checkbox" id="${cleanKey}" ${dataOriginalKey} ${value ? 'checked' : ''}>
                                <span class="slider"></span>
                            </label>
                        `;
                    } else if (typeof value === 'number' && key.includes('opacity')) {
                        inputHtml = `
                            <div class="flex items-center gap-2 w-full max-w-[200px]">
                                <input type="range" id="${cleanKey}_range" ${dataOriginalKey} min="0" max="1" step="0.01" value="${value}" class="flex-grow h-2 rounded-lg appearance-none cursor-pointer bg-color-primary/50" />
                                <input type="number" id="${cleanKey}_number" ${dataOriginalKey} min="0" max="1" step="0.01" value="${value}" class="input-field w-20 text-center" />
                            </div>
                        `;
                    } else if (typeof value === 'string' && key.includes('anchor')) {
                        const optionsHtml = anchorOptions.map(opt => `<option value="${opt}" ${value === opt ? 'selected' : ''}>${sanitizeKeyForDisplay(opt)}</option>`).join('');
                        inputHtml = `
                            <select id="${cleanKey}" ${dataOriginalKey} class="select-field w-auto min-w-[150px]">
                                ${optionsHtml}
                            </select>
                        `;
                    } else if (cleanKey === '$chat_toggle_index') {
                        const optionsHtml = Object.entries(chatToggleOptions).map(([idx, label]) => `<option value="${idx}" ${value == idx ? 'selected' : ''}>${label}</option>`).join('');
                        inputHtml = `<select id="${cleanKey}" ${dataOriginalKey} class="select-field w-auto min-w-[150px]">${optionsHtml}</select>`;
                    } else if (cleanKey === '$hotbar_toggle_index') {
                        const optionsHtml = Object.entries(hotbarToggleOptions).map(([idx, label]) => `<option value="${idx}" ${value == idx ? 'selected' : ''}>${label}</option>`).join('');
                        inputHtml = `<select id="${cleanKey}" ${dataOriginalKey} class="select-field w-auto min-w-[150px]">${optionsHtml}</select>`;
                    } else if (cleanKey === '$inventoryhud_toggle_index') {
                        const optionsHtml = Object.entries(inventoryHudToggleOptions).map(([idx, label]) => `<option value="${idx}" ${value == idx ? 'selected' : ''}>${label}</option>`).join('');
                        inputHtml = `<select id="${cleanKey}" ${dataOriginalKey} class="select-field w-auto min-w-[150px]">${optionsHtml}</select>`;
                    } else if (cleanKey === '$mainhand_durability_toggle_index') {
                        const optionsHtml = Object.entries(mainhandDurabilityToggleOptions).map(([idx, label]) => `<option value="${idx}" ${value == idx ? 'selected' : ''}>${label}</option>`).join('');
                        inputHtml = `<select id="${cleanKey}" ${dataOriginalKey} class="select-field w-auto min-w-[150px]">${optionsHtml}</select>`;
                    } else if (typeof value === 'number') {
                        inputHtml = `<input type="number" id="${cleanKey}" ${dataOriginalKey} value="${value}" class="input-field w-auto min-w-[100px] text-center" />`;
                    } else {
                        console.warn("Unhandled type for key:", key, value);
                        inputHtml = `<input type="text" id="${cleanKey}" ${dataOriginalKey} value="${JSON.stringify(value)}" class="input-field" disabled />`;
                    }

                    configForm.appendChild(createFormGroup(displayLabel, inputHtml));
                }
            }

            configForm.appendChild(createSectionHeader('Pause Menu Configuration'));
            for (const key in pauseMenuConfig) {
                if (pauseMenuConfig.hasOwnProperty(key)) {
                    const displayLabel = sanitizeKeyForDisplay(key);
                    const value = pauseMenuConfig[key];
                    const inputHtml = `
                        <label class="toggle-switch">
                            <input type="checkbox" id="${key}" data-original-key="${key}" ${value ? 'checked' : ''}>
                            <span class="slider"></span>
                        </label>
                    `;
                    configForm.appendChild(createFormGroup(displayLabel, inputHtml));
                }
            }

            configForm.appendChild(createSectionHeader('Container Configuration'));
            for (const key in containerConfig) {
                if (containerConfig.hasOwnProperty(key)) {
                    const displayLabel = sanitizeKeyForDisplay(key);
                    const value = containerConfig[key];
                    const inputHtml = `
                        <label class="toggle-switch">
                            <input type="checkbox" id="${key}" data-original-key="${key}" ${value ? 'checked' : ''}>
                            <span class="slider"></span>
                        </label>
                    `;
                    configForm.appendChild(createFormGroup(displayLabel, inputHtml));
                }
            }

            configForm.addEventListener('input', updateConfigFromForm);
            configForm.addEventListener('change', updateConfigFromForm);

            const formAnimatedElements = configForm.querySelectorAll('.animate-fade-in-up');
            formAnimatedElements.forEach(element => {
                element.classList.add('is-visible');
            });
        }

        function updateConfigFromForm(event) {
            const target = event.target;
            const originalKey = target.dataset.originalKey || target.id;
            const value = target.value;
            const type = target.type;

            let sectionKey = "mod_menu_config@gc.pnl";
            if (originalKey.includes('pause_menu_config')) sectionKey = "pause_menu_config@gc.pnl";
            else if (originalKey.includes('container_config')) sectionKey = "container_config@gc.pnl";

            if (type === 'checkbox') {
                currentConfig[sectionKey][originalKey] = target.checked;
            } else if (type === 'range' || (type === 'number' && originalKey.includes('opacity'))) {
                const numValue = parseFloat(value);
                currentConfig[sectionKey][originalKey] = numValue;
                const cleanKey = originalKey.replace(/\|default/g, '');
                document.getElementById(`${cleanKey}_range`).value = numValue;
                document.getElementById(`${cleanKey}_number`).value = numValue;
            } else if (type === 'number' && (originalKey.endsWith('_item_id') || originalKey.endsWith('_aux') || originalKey.endsWith('_preset_index') || originalKey.endsWith('_toggle_index'))) {
                currentConfig[sectionKey][originalKey] = parseInt(value, 10);
            } else if (originalKey.endsWith('_offset|default')) {
                const cleanKey = originalKey.replace(/\|default/g, '');
                const xInput = document.querySelector(`[data-original-key="${originalKey}"][id="${cleanKey}_x"]`);
                const yInput = document.querySelector(`[data-original-key="${originalKey}"][id="${cleanKey}_y"]`);

                currentConfig[sectionKey][originalKey] = [parseFloat(xInput.value), parseFloat(yInput.value)];
            } else {
                currentConfig[sectionKey][originalKey] = value;
            }

            updateMonacoEditor();
        }

        function initializeMonacoEditor() {
            require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.49.0/min/vs' } });
            require(['vs/editor/editor.main'], () => {
                monacoEditor = monaco.editor.create(jsonEditorContainer, {
                    value: JSON.stringify(currentConfig, null, 4),
                    language: 'json',
                    theme: 'vs-dark',
                    readOnly: false,
                    automaticLayout: false,
                    minimap: { enabled: false }
                });

                window.addEventListener('resize', () => {
                    if (monacoEditor) {
                        monacoEditor.layout();
                    }
                });

                let monacoUpdateTimeout;
                monacoEditor.onDidChangeModelContent(() => {
                    clearTimeout(monacoUpdateTimeout);
                    monacoUpdateTimeout = setTimeout(() => {
                        const jsonText = monacoEditor.getValue();
                        try {
                            const parsedJson = JSON.parse(jsonText);
                            currentConfig = parsedJson;
                            renderConfigForm(currentConfig);
                        } catch (e) {
                            if (jsonText.trim() !== "") {
                                console.error("Invalid JSON format in editor. Form not updated.", e);
                            }
                        }
                    }, 500);
                });
            });
        }

        function updateMonacoEditor() {
            if (monacoEditor) {
                const currentEditorValue = monacoEditor.getValue();
                const newEditorValue = JSON.stringify(currentConfig, null, 4);
                if (currentEditorValue !== newEditorValue) {
                    monacoEditor.setValue(newEditorValue);
                }
            }
        }

        downloadConfigBtn.addEventListener('click', () => {
            const blob = new Blob([JSON.stringify(currentConfig, null, 4)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'config.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        copyJsonBtn.addEventListener('click', () => {
            if (monacoEditor) {
                const textToCopy = monacoEditor.getValue();
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                try {
                    document.execCommand('copy');
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                }
                document.body.removeChild(tempTextArea);
            }
        });

        window.onload = async () => {
            try {
                const response = await fetch('config.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                currentConfig = await response.json();
                renderConfigForm(currentConfig);
                initializeMonacoEditor();

                const mainPanels = document.querySelectorAll('.panel.animate-fade-in-up');
                mainPanels.forEach(panel => {
                    panel.classList.add('is-visible');
                });

            } catch (e) {
                console.error("Error loading config.json:", e);
                configForm.innerHTML = `<p class="text-red-500 text-center">Error loading configuration: ${e.message}</p>`;
            }
        };
    </script>
</body>
</html>